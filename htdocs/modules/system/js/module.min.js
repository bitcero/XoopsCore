function module_Detail(o){var a=$("#mid-"+o).position();$("#detail-"+o).css({position:"absolute","box-shadow":"2px 2px 1px #888",top:a.top+"px",left:a.left+"px"}),$("#detail-"+o).slideDown(600)}function module_Disable(o,a,e){$.post("admin.php",{fct:"modulesadmin",op:"active",mid:o},function(t,n){"success"==n&&(t?($("#active-"+o).html('<span class="icon icon-tick"></span>'+a),$("#active-table-"+o).html('<span class="icon icon-tick">&nbsp;</span>')):($("#active-"+o).html('<span class="icon icon-cross"></span>'+e),$("#active-table-"+o).html('<span class="icon icon-cross">&nbsp;</span>')))})}function module_Hide(o){$.post("modules.php",{op:"display_in_menu",mid:o},function(a,e){"success"==e&&$("#menu-hide-"+o).html(0!=a?'<span class="cursorpointer icon icon-cross">&nbsp;</span>':'<span class="cursorpointer icon icon-tick">&nbsp;</span>')})}function module_Install(o){$(".modal-backdrop").show(),$("#install-dir").val(o),$("#install .modal-data").html($("#data-"+o+" .module_card").html()),$("#install").show("slow")}function module_Uninstall(o){$(".modal-backdrop").show(),$("#uninstall-id").val(o),$("#uninstall .modal-data").html($("#data-"+o+" .module_card").html()),$("#uninstall").show("slow")}!function(o){function a(a){o("body").xoPreload();var e={XOOPS_TOKEN_REQUEST:o("#xo-token").val(),op:"update",mid:a};return o.post("modules.php",e,function(a){if(!xoops.AJAX.retrieve(a))return o("body").xoPreload({action:"hide"}),!1;if(o("body").xoPreload({action:"hide"}),xoops.modal.dialog({title:a.title,message:a.content,color:"primary",id:"module-logger",buttons:{main:{label:void 0!=a.close?a.close:xoLang.close,className:"btn-primary"}}}),o("#table-installed-modules")){var e=o(".xo-item-options a[data-action='module-update'][data-id='"+a.mid+"']");if(e.length<=0)return!1;e.parents("tr").find(".version").html(a.version),e.parents("tr").find(".updated").html(a.updated)}},"json"),!1}function e(a,e,t){var n={XOOPS_TOKEN_REQUEST:o("#xo-token").val(),op:"change-view",logo_mode:t,mode:e,tab:o(".xo-moduleadmin-buttons .btn-primary").attr("href").replace("#","")};o("#view-canvas").xoPreload({action:"show"}),o.post("modules.php",n,function(a){return xoops.AJAX.retrieve(a)?("available"==a.list?o("#available-modules").html(a.content):o("#installed-modules").html(a.content),o("#view-canvas").xoPreload({action:"hide"}),void o("#view-canvas").data("mode",a.mode)):(xoops.notify({title:a.message.title,text:a.message.text,delay:7e3,type:"danger",nonblock:{nonblock:!0,nonblock_opactity:.2}}),o("#view-canvas").xoPreload({action:"hide"}),!1)},"json")}var t={};o(document).ready(function(){o("body").on("click","*[data-action]",function(){var a=o(this).data("id"),e=o(this).data("action").replace("-","_");return"function"==typeof t[e]?t[e](a):!1}),o("input[name='view_mode'],input[name='view_logo']").change(function(){var a=o("#view-canvas");if("view_mode"==o(this).attr("name")&&a.data("mode")==o(this).data("mode"))return!1;var t="view_mode"==o(this).attr("name")?o(this).data("mode"):o(".header-commands input[name='view_mode']:checked").data("mode"),n="view_logo"==o(this).attr("name")?o(this).data("mode"):o(".header-commands input[name='view_logo']:checked").data("mode");e(o(this),t,n)}),o(".rename").editable("modules.php?op=rename",{indicator:"<img src='../../media/xoops/images/spinner.gif'>",cssclass:"span2"}),o("body").on("click",'[data-action="module-info"]',function(){o("body").xoPreload();var a={XOOPS_TOKEN_REQUEST:o("#xoops-token").val(),op:"details",mid:o(this).data("mid")};return o.get("modules.php",a,function(a){return"error"==a.type?(xoops.modal.alert(a.message),o("body").xoPreload({action:"hide"}),!1):(xoops.modal.dialog({title:a.title,message:a.content,color:1==a.installed?"primary":"danger",id:"module-details",buttons:{main:{label:a.close,className:"btn-primary"}}}),void o("body").xoPreload({action:"hide"}))},"json"),!1}),o("body").on("click",'[data-action="module-update"]',function(){return confirm(xoLang.confirmUpdate)&&a(o(this).data("id")),!1}),o("body").on("click",'[data-action="module-uninstall"]',function(){if(!confirm(xoLang.confirmUninstall))return!1;o("body").xoPreload();var a={XOOPS_TOKEN_REQUEST:o("#xo-token").val(),op:"uninstall",mid:o(this).data("id")};return o.post("modules.php",a,function(a){if(!xoops.AJAX.retrieve(a))return o("body").xoPreload({action:"hide"}),!1;if(o("body").xoPreload({action:"hide"}),xoops.modal.dialog({title:a.title,message:a.content,color:"danger",id:"module-logger",buttons:{main:{label:void 0!=a.close?a.close:xoLang.close,className:"btn-primary"}}}),o("#table-installed-modules")){var e=o(".xo-item-options a[data-action='module-update'][data-id='"+a.mid+"']");if(e.length<=0)return!1;e.parents("tr").remove()}else o("#mid-"+a.mid).remove()},"json"),!1}),o("body").on("click",'#installed-modules [data-action="module-active"]',function(){if("module-disable"==o(this).data("action")&&!confirm(xoLang.confirmDisable))return!1;var a=o(this).data("id");if(void 0==a||0>=a)return xoops.notify({title:xoLang.error,text:xoLang.noId,addclass:"alert-danger",icon:"xicon-alert-triangle",opacity:1,nonblock:{nonblock:!1}}),!1;o("body").xoPreload();var e={XOOPS_TOKEN_REQUEST:o("#xo-token").val(),op:"active",mid:a};return o.post("modules.php",e,function(a){if(!xoops.AJAX.retrieve(a))return xoops.modal.alert(a.message),o("body").xoPreload({action:"hide"}),!1;o("body").xoPreload({action:"hide"}),xoops.notify({title:xoLang.activationResult,text:a.message,addclass:1==a.active?"alert-success":"alert-warning",icon:"xicon-thumb-up",opacity:1,nonblock:{nonblock:!1}});var e=o("li.active-btn > [data-id='"+a.mid+"']");return e.length<=0?!1:void(1==a.active?(e.attr("title",xoLang.disable),e.attr("class","bg-warning"),xoops.loadIcon("xicon-pause-circle",e),e.parents("tr").removeClass("disabled")):(e.attr("title",xoLang.enable),e.attr("class","bg-success"),xoops.loadIcon("xicon-play-circle",e),e.parents("tr").addClass("disabled")))},"json"),!1}),o("body").on("click",'a[data-toggle="modules"]',function(){var a=o(this).attr("href"),e=o(this);if(o(e).siblings().removeClass("btn-primary"),o(a+"-modules").is(":visible"))return!1;var t={XOOPS_TOKEN_REQUEST:o("#xo-token").val(),op:a.replace("#","")+"-modules"};return o("body").xoPreload(),o.get("modules.php",t,function(t){return xoops.AJAX.retrieve(t)?(o(a+"-modules").html(t.content),o("body").xoPreload({action:"hide"}),e.addClass("btn-primary"),o(".modules-container > div").removeClass("active"),o(a+"-modules").addClass("active"),void("#installed"==a&&o(".rename").editable("modules.php?op=rename",{indicator:"<img src='../../media/xoops/images/spinner.gif'>",cssclass:"span2"}))):!1},"json"),!1}),o("body").on("click",'#available-modules [data-action="module-install"]',function(){if(!confirm(xoLang.confirmInstall))return!1;o("body").xoPreload();var a={XOOPS_TOKEN_REQUEST:o("#xo-token").val(),op:"install",dirname:o(this).data("dirname")};return o.post("modules.php",a,function(a){return xoops.AJAX.retrieve(a)?(o("body").xoPreload({action:"hide"}),xoops.modal.dialog({title:a.title,message:a.content,color:"success",id:"module-logger",buttons:{main:{label:void 0!=a.close?a.close:xoLang.close,className:"btn-success"}}}),void o("#mid-"+a.dirname).remove()):(o("body").xoPreload({action:"hide"}),!1)},"json"),!1})})}(jQuery);
